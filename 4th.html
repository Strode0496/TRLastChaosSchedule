<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>테일즈런너 라스트 카오스 4차 업데이트 점령전 시간표</title>

	<!-- 탭 아이콘 이미지 지정 -->
	<link rel="icon" href="https://trimage.rhaon.co.kr/favicon.ico"/> 

	<!-- 웹폰트 지정	-->
	<link href="https://cdn.jsdelivr.net/gh/sun-typeface/SUITE@2/fonts/static/woff2/SUITE.css" rel="stylesheet">

	<!-- 스타일 -->
	<style>

/*		CSS 초기화 */
		html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video{margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline;}
		article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section{display: block;}
		body{line-height: 1;}
		ol, ul{list-style: none;}
		blockquote, q{quotes: none;}
		blockquote:before, blockquote:after, q:before, q:after{content: ''; content: none;}
		table{border-collapse: collapse; border-spacing: 0;}

/*		웹폰트 적용, 페이지 배경 검은색 지정 */
		body{
			font-family: 'SUITE', sans-serif;
			font-feature-settings: 'ss17', 'tnum';
			background-color: black;
		}

/*		배경 동영상 */
		div.bgVideo{
			position: fixed; top: 0; left: 0;
			height: 100%; width: 100%;
			opacity: 0.3;
			z-index: -10;
		}
		.bgVideoContent{
			height: 100%;
			width: 100%;
			object-fit: cover;
		}

/*		상단 고정 바, 제목 */
		header{
			width: 100%;
			height: 100px;
			position: fixed; top: 0; left: 0; right: 0;
			background-color: rgba(0, 0, 0, 0);
			backdrop-filter: blur(16px) brightness(1.3);
			box-sizing: border-box;
			border-bottom: solid 2px lavender;
			z-index: 10;
		}
		h1, h2{
			color: lavender; display: block; text-align: center;
		}
		h1{
			font-weight: 800;
			font-size: 2em;
			margin-top: 24px; margin-bottom: 4px;
		}
		h2{
			font-weight: bold;
		}

/*		시간 표시 바 */
		.currentTime{
			width: 100%; height: 30px;
			position: fixed; top: 100px; left: 0; right: 0;
			line-height: 30px;
			color: lavenderblush; font-weight: bold; text-align: center;
			border-bottom: solid 2px lavender;
			background-color: rgba(0, 0, 0, 0);
			backdrop-filter: blur(16px) brightness(0.7);
			z-index: 10;
		}

/*		시간 표시 바 아래 그림자 */
		div.headerShadow{
			width: 100%; height: 30px;
			position: fixed; top: 130px; left: 0; right: 0;
			background: linear-gradient(0deg, #00000000 0%, #00000081 100%);
			z-index: 9;
		}

/*		fixed 요소들에 의해 가려진 영역 */
		.headerBehind{
			width: 100%;
			height: 130px;
/*			margin-bottom: 10px;*/
		}

/*		메인 영역 */
		main{
			text-align: center;
		}

/*		일정 날짜 표시 */
		.date{
			width: 300px;
			height: 30px;
			margin: 20px auto 10px auto;
			color: lavender;
			font-weight: 800;
			font-size: 1.2em;
			line-height: 30px;
			text-align: center;
			border: solid 2px lavender; border-radius: 4px;
			backdrop-filter: brightness(0.7);
		}

/*		일정 시각 표시 */
		.time{
			font-weight: bold;
			width: 200px;
			padding: 8px 0;
			display: inline-block;
			color: lavenderblush;
			text-align: center;
			border: solid 2px lavenderblush; border-radius: 4px;
			backdrop-filter: brightness(0.7);
			margin: 0 2px;
		}
		.time>hr{
			width: 180px;
			border: solid 1px lavenderblush;
		}
		.time>p:nth-child(1){font-weight: 800;}

/*		일정 시각 표시(이미 지나간 일정) */
		.pastDate, .pastTime{
			color: dimgray !important;
			border-color: dimgray !important;
		}
		.pastTime hr{
			border-color: dimgray !important;
		}

/*		일정 시각 표시(진행 중인 일정) */
		@keyframes scheduleBlinkRainbow{
			100%,0%{color: pink; border-color: pink;}
			8%{color: sandybrown; border-color: sandybrown;}
			16%{color: gold; border-color: gold;}
			25%{color: greenyellow; border-color: greenyellow;}
			33%{color: palegreen; border-color: palegreen;}
			41%{color: aquamarine; border-color: aquamarine;}
			50%{color: powderblue; border-color: powderblue;}
			58%{color: lightskyblue; border-color: lightskyblue;}
			66%{color: thistle; border-color: thistle;}
			75%{color: plum; border-color: plum;}
			83%{color: mediumpurple; border-color: mediumpurple;}
			91%{color: hotpink; border-color: hotpink;}
		}
		.nowTime{
			animation: scheduleBlinkRainbow 15s ease infinite !important;
			backdrop-filter: brightness(1.5) !important;
		}
		.nowTime hr{
			animation: scheduleBlinkRainbow 15s ease infinite !important;
		}

/*		하단 */
		footer{
			text-align: center;
			color: gray;
			margin-top: 20px;
		}

/*		모바일 환경 대응 */
		@media (max-width: 575px) {

/*			상단 고정 바 */
			header{
				height: 120px;
			}
			h1,h2{
				display: block;
			}
			h1>span{
				display: block;
			}
			h2>span{
				display: none;
			}

/*			시간 표시 바 */
			.currentTime{
				position: fixed; top: 120px; left: 0; right: 0;
			}

/*			시간 표시 바 아래 그림자 */
			div.headerShadow{
				position: fixed; top: 150px; left: 0; right: 0;
			}

/*			fixed 요소들에 의해 가려진 영역 */
			.headerBehind{
				height: 150px;
			}

/*			일정 날짜 표시 */
			.date{
				width: 90%;
			}

/*			일정 시각 표시 */
			.time{
				width: 80%;
				padding: 8px 0;
				display: block;
				margin: 0 auto;
				margin-bottom: 5px;
			}
			.time>hr{
				width: 90%;
			}

/*			하단 */
			footer>span{
				display: block;
			}

		}

	</style>

</head>

<body>

	<!-- 배경 동영상 -->
	<div class="bgVideo">
		<video class="bgVideoContent" autoplay muted loop>
			<source src="bg2-1.webm" type="video/webm" />
		</video>
	</div>

	<!-- 상단 고정 바 -->
	<header>
		<h1><span>테일즈런너 라스트 카오스</span> <span>점령전 일정</span></h1>
		<h2>기간: <span>라스트 카오스 4차 업데이트부터 5차 업데이트 이전까지; </span>2025.01.22. ~ 2025.02.12.</h2>
	</header>
	<div class="headerShadow"></div>

	<!-- 상단 고정 바 아래 현재 시각 표시(스크립트 사용) -->
	<div class="currentTime"></div>

	<!-- 상단 고정 바에 가려진 영역 -->
	<div class="headerBehind"></div>

	<!-- 메인 -->
	<main></main>

	<!-- 하단 -->
	<footer><span>Copyright 2025. Strode0496</span> <span>All Rights Reserved.</span></footer>
	
</body>

<script>

	document.addEventListener('DOMContentLoaded', function(){

		// 헬퍼 함수들

		// ID에서 타임스탬프를 추출 (날짜 요소와 시간 요소 구분)
		function parseElementTime(id){
			if(id.endsWith("999999")){
				// 날짜 ID에 있는 YYYYMMDD999999에서 999999를 떼고 날짜 부분만 사용
				return new Date(
					parseInt(id.slice(0, 4)),
					parseInt(id.slice(4, 6)) - 1,
					parseInt(id.slice(6, 8))
				).getTime();
			} else {
				// 시간 ID에 있는 YYYYMMDDHHMMSS는 전체 사용
				return new Date(
					parseInt(id.slice(0, 4)),
					parseInt(id.slice(4, 6)) - 1,
					parseInt(id.slice(6, 8)),
					parseInt(id.slice(8, 10)),
					parseInt(id.slice(10, 12)),
					parseInt(id.slice(12, 14))
				).getTime();
			}
		}

		// 시간을 HH:MM:SS 형식으로 변경
		function formatRemainingTime(totalSeconds) {
			const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
			const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
			const seconds = String(Math.floor(totalSeconds % 60)).padStart(2, '0');
			return `${hours}:${minutes}:${seconds}`;
		}
		
		// 현재 시각 실시간 표시
		function updateTime() {
			const now = new Date();
			const year = now.getFullYear();
			const month = String(now.getMonth() + 1).padStart(2, '0');
			const day = String(now.getDate()).padStart(2, '0');
			const hours = now.getHours();
			const minutes = String(now.getMinutes()).padStart(2, '0');
			const seconds = String(now.getSeconds()).padStart(2, '0');
			const ampm = hours >= 12 ? '오후' : '오전';
			const hours12 = String(hours % 12 || 12).padStart(2, '0');
			const dayOfWeek = ['일', '월', '화', '수', '목', '금', '토'][now.getDay()];
			const formattedTime = `현재 시각: ${year}.${month}.${day}.(${dayOfWeek}) ${ampm} ${hours12}:${minutes}:${seconds}`;
			document.querySelector('.currentTime').textContent = formattedTime;
		}
		
		// 일정 생성 
		const schedules = [
			{date: "2025.01.22.(수)", times: ["오전 10:00", "오후 09:00"]},
			{date: "2025.01.23.(목)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.01.24.(금)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.01.25.(토)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.26.(일)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.27.(월)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.28.(화)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.29.(수)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.30.(목)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.01.31.(금)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.01.(토)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.02.02.(일)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.02.03.(월)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.04.(화)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.05.(수)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.06.(목)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.07.(금)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.08.(토)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.02.09.(일)", times: ["오전 12:10", "오후 04:00", "오후 09:00"]},
			{date: "2025.02.10.(월)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.11.(화)", times: ["오전 12:10", "오후 09:00"]},
			{date: "2025.02.12.(수)", times: ["오전 12:10", "오전 10:00"]}
		];

		// 일정 요소 생성
		const mainElement = document.querySelector('main');
		schedules.forEach(schedule => {
			// 날짜 요소 생성
			const dateElement = document.createElement('div');
			dateElement.classList.add('date');
			dateElement.innerHTML = `<p>${schedule.date}</p>`;
			// 날짜 ID는 위 schedules의 date에서 숫자만 추출하고 999999를 붙여서 YYYYMMDD999999 형식으로 추가
			dateElement.id = schedule.date.replace(/[^\d]/g, '') + '999999';
			mainElement.appendChild(dateElement);

			// 시간 요소 생성
			schedule.times.forEach(time => {
				const timeElement = document.createElement('div');
				timeElement.classList.add('time');
				timeElement.innerHTML = `
					<p>${time}</p>
					<hr>
					<p>점령전 시작 전</p>
				`;
				// 시간 ID는 date에서 춧자만 추출하고 times에서는 숫자와 ':'만 남긴 후 시, 분 처리, 그리고 '00' 추가
				let timeString = time.replace(/[^\d:]/g, '');
				let [hour, minute] = timeString.split(':');
				if(hour === '12' && time.includes('오전')){
					hour = '00';
				}
				if(hour === '12' && time.includes('오후')){
					hour = '12';
				}
				if(time.includes('오후') && hour !== '12'){
					hour = String(parseInt(hour) + 12);
				}
				timeElement.id = schedule.date.replace(/[^\d]/g, '') + hour + minute + '00';
				mainElement.appendChild(timeElement);
			});
		});

		// 클래스 업데이트 함수들

		// 과거 일정 처리
		function updatePastClasses() {
			const nowTime = Date.now();

			// 날짜 요소 ID의 앞 8자리(YYYYMMDD)를 사용하여 비교
			document.querySelectorAll('.date').forEach(element => {
				const id = element.id;
				if (id) {
					const datePart = id.substring(0, 8);
					const elementTime = new Date(
						parseInt(datePart.slice(0,4)),
						parseInt(datePart.slice(4,6)) - 1,
						parseInt(datePart.slice(6,8))
					).getTime();
					// 하루 지난 경우 과거 처리
					if(nowTime >= elementTime + 24 * 60 * 60 * 1000){
						element.classList.add('pastDate');
					}
				}
			});

			// 시간 요소의 종료 시간이 지났으면 과거 처리
			document.querySelectorAll('.time').forEach(element => {
				const id = element.id;
				if (id) {
					const startTime = parseElementTime(id);
					// 점령전은 1시간 38분 동안 진행됨 (종료되면 과거 클래스 추가)
					const endTime = startTime + (1 * 60 * 60 + 38 * 60) * 1000;
					if (nowTime >= endTime) {
						element.classList.add('pastTime');
						const secondParagraph = element.querySelectorAll('p')[1];
						if (secondParagraph) {
							secondParagraph.textContent = '점령전 종료됨';
						}
					}
				}
			});
		}

		// 곧 시작될 일정 처리 (가장 가까운 미래의 요소)
		function updateUpcomingClasses(){
			const nowTime = Date.now();
			let closestTimeElement = null;
			let closestTimeDiff = Infinity;

			document.querySelectorAll('.time').forEach(element => {
				const id = element.id;
				if (id) {
					const eventTime = parseElementTime(id);
					if (eventTime > nowTime && eventTime - nowTime < closestTimeDiff) {
						closestTimeElement = element;
						closestTimeDiff = eventTime - nowTime;
					}
				}
			});

			if (closestTimeElement) {
				const remainingSeconds = closestTimeDiff / 1000;
				const timeStr = formatRemainingTime(remainingSeconds);
				const secondParagraph = closestTimeElement.querySelectorAll('p')[1];
				if (secondParagraph) {
					secondParagraph.textContent = `${timeStr} 뒤 점령전 시작`;
				}
			}
		}

		// 진행 중인 일정 처리
		function updateOngoingClasses() {
			const nowTime = Date.now();
			document.querySelectorAll('.time').forEach(element => {
				const id = element.id;
				if(id){
					const startTime = parseElementTime(id);
					// 점령전은 1시간 38분 동안 진행됨 (요소 문구 실시간 수정)
					const endTime = startTime + (1 * 60 * 60 + 38 * 60) * 1000;
					if(nowTime >= startTime && nowTime < endTime){
						const remainingSeconds = (endTime - nowTime) / 1000;
						const timeStr = formatRemainingTime(remainingSeconds);
						const secondParagraph = element.querySelectorAll('p')[1];
						if(secondParagraph){
							secondParagraph.textContent = `${timeStr} 뒤 점령전 종료`;
						}
						if(!element.classList.contains('nowTime')){
							element.classList.add('nowTime');
						}
					}
				}
			});
		}

		// 지금의 일정으로 스크롤 이동
		function scrollToToday() {
			const now = new Date();
			const todayDateString = now.getFullYear() +
				String(now.getMonth() + 1).padStart(2, '0') +
				String(now.getDate()).padStart(2, '0') + '999999';
			const todayDateElement = document.querySelector(`#${CSS.escape(todayDateString)}`);
			if (todayDateElement) {
				todayDateElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
			}
		}

		// 헬퍼 함수: ID 파싱 및 시간 포맷
		function parseElementTime(id) {
			if (id.endsWith("999999")) {
				// 날짜 요소: 앞 8자리만 사용
				return new Date(
					parseInt(id.slice(0, 4)),
					parseInt(id.slice(4, 6)) - 1,
					parseInt(id.slice(6, 8))
				).getTime();
			} else {
				// 시간 요소: 전체 14자리 사용
				return new Date(
					parseInt(id.slice(0, 4)),
					parseInt(id.slice(4, 6)) - 1,
					parseInt(id.slice(6, 8)),
					parseInt(id.slice(8, 10)),
					parseInt(id.slice(10, 12)),
					parseInt(id.slice(12, 14))
				).getTime();
			}
		}

		function formatRemainingTime(totalSeconds) {
			const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
			const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
			const seconds = String(Math.floor(totalSeconds % 60)).padStart(2, '0');
			return `${hours}:${minutes}:${seconds}`;
		}

		// 주기적 업데이트 설정
		setInterval(updateTime, 1000);
		updateTime();

		setInterval(updatePastClasses, 1000);
		updatePastClasses();

		setInterval(updateUpcomingClasses, 1000);
		updateUpcomingClasses();

		setInterval(updateOngoingClasses, 1000);
		updateOngoingClasses();

		// 초기 스크롤 이동
		scrollToToday();
	});

</script>
</html>
